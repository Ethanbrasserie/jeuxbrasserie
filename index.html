<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>2√®me partie - Les 10 D√©fis</title>
<style>
  body { font-family: Arial, sans-serif; background: #1a1a1a; color: #f5f5f5; text-align: center; margin: 0; padding: 0; display: flex; flex-direction: column; min-height: 100vh; }
  header { background: #0e0e0e; padding: 15px; font-size: 24px; font-weight: bold; }
  #story-message { background: #3a3a3a; padding: 10px; font-size: 1.2em; color: #ff9800; }
  #menu { display: flex; flex-wrap: wrap; justify-content: center; background: #222; padding: 10px; }
  .game-btn { background: #4CAF50; border: none; color: white; margin: 5px; padding: 10px 15px; border-radius: 6px; cursor: pointer; flex: 1 1 140px; max-width: 150px; transition: background 0.3s; }
  .game-btn.completed { background: #008CBA; }
  .game-btn:disabled { opacity: 0.5; cursor: not-allowed; }
  #game-container { padding: 20px; min-height: 320px; }
  #message { margin-top: 20px; font-size: 22px; }
  #reveal-container { display: none; margin-top: 50px; }
  .reveal-btn { background: #ff4500; border: none; color: white; padding: 20px 40px; font-size: 2em; border-radius: 10px; cursor: pointer; }
  button.answer-btn { background: #008CBA; margin: 10px; padding: 15px 30px; font-size: 20px; border-radius: 8px; border: none; cursor: pointer; transition: background 0.3s; }
  button.answer-btn:hover { background: #007B9E; }
  input[type=text], input[type=number] { font-size: 18px; padding: 8px; width: 200px; border-radius: 6px; border: none; margin-top: 10px; }
</style>
</head>
<body>

<header>
  <span>2√®me partie - Les 10 D√©fis</span>
</header>
<div id="story-message">R√©ussis les 10 nouveaux d√©fis pour d√©couvrir le nom du cr√©ateur du jeu.</div>
<div id="menu"></div>
<div id="game-container"></div>
<div id="message"></div>
<div id="reveal-container">
    <h2>F√©licitations ! Vous avez r√©ussi tous les d√©fis.</h2>
    <h3>Cliquez sur le bouton pour d√©couvrir le nom de l'√©nigmiste.</h3>
    <button class="reveal-btn" onclick="revealCreatorName()">D√©couvrir le nom</button>
</div>

<script>
// √âtat du jeu
const gameProgress = JSON.parse(localStorage.getItem('gameProgress')) || {};

// V√©rifie si tous les d√©fis sont termin√©s
function checkAllGamesCompleted() {
    const allCompleted = games.every(game => gameProgress[game.id]);
    if (allCompleted) {
        document.getElementById('reveal-container').style.display = 'block';
        document.getElementById('story-message').textContent = "Tu as r√©ussi tous les d√©fis !";
    } else {
        document.getElementById('reveal-container').style.display = 'none';
        const completedCount = Object.keys(gameProgress).length;
        document.getElementById('story-message').textContent = `D√©fis r√©ussis : ${completedCount} / 10. Courage !`;
    }
}

// Fonction appel√©e quand un d√©fi est r√©ussi
function completeDefi(id) {
    if (!gameProgress[id]) {
        gameProgress[id] = true;
        localStorage.setItem('gameProgress', JSON.stringify(gameProgress));
        const btn = document.getElementById(id);
        if (btn) {
            btn.classList.add('completed');
        }
        checkAllGamesCompleted();
    }
}

// R√©v√©lation du nom du cr√©ateur
function revealCreatorName() {
    const container = document.getElementById('game-container');
    const message = document.getElementById('message');
    container.innerHTML = '<h1>Le nom du cr√©ateur est... ETHAN !</h1><p>Merci d\'avoir jou√© !</p>';
    message.textContent = "";
    document.getElementById('reveal-container').style.display = 'none';
}

// --- Les 10 NOUVEAUX d√©fis ---
const games = [
    { id: 'devinechiffre', name: "D√©fi 1: Devine le chiffre", fn: jeuDevineChiffre },
    { id: 'melange', name: "D√©fi 2: Mot m√©lang√©", fn: jeuMotMelange },
    { id: 'compte', name: "D√©fi 3: Compte les fruits", fn: jeuCompteFruits },
    { id: 'ordrealpha', name: "D√©fi 4: Ordre alphab√©tique", fn: jeuOrdreAlpha },
    { id: 'couleurmemoire', name: "D√©fi 5: Couleurs en m√©moire", fn: jeuCouleurMemoire },
    { id: 'riddles', name: "D√©fi 6: √ânigmes", fn: jeuEnigmes },
    { id: 'poids', name: "D√©fi 7: Le Poids Id√©al", fn: jeuPoidsIdeal },
    { id: 'veritefaux', name: "D√©fi 8: V√©rit√© ou Mensonge", fn: jeuVeriteMensonge },
    { id: 'symbole', name: "D√©fi 9: Le Symbole Manquant", fn: jeuSymboleManquant },
    { id: 'seriesuite', name: "D√©fi 10: La S√©rie de Formes", fn: jeuSerieFormes },
];

// Cr√©ation du menu des d√©fis
const menu = document.getElementById('menu');
games.forEach(g => {
    const btn = document.createElement('button');
    btn.textContent = g.name;
    btn.id = g.id;
    btn.classList.add('game-btn');
    btn.onclick = () => {
        reset();
        g.fn();
    };
    if (gameProgress[g.id]) {
        btn.classList.add('completed');
    }
    menu.appendChild(btn);
});

function reset() {
    const container = document.getElementById('game-container');
    const message = document.getElementById('message');
    container.innerHTML = '';
    message.textContent = '';
}

// Appel initial
checkAllGamesCompleted();

// --- Fonctions des 10 nouveaux jeux ---

// D√©fi 1: Devine le chiffre
function jeuDevineChiffre() {
    reset();
    const chiffreSecret = Math.floor(Math.random() * 100) + 1;
    let tentatives = 0;
    document.getElementById('game-container').innerHTML = `
        <h2>D√©fi 1: Devine le chiffre</h2>
        <p>Devine un nombre entre 1 et 100.</p>
        <input type="number" id="guessInput" />
        <br/><br/>
        <button class="answer-btn" id="guessBtn">Valider</button>
    `;
    document.getElementById('guessBtn').onclick = () => {
        const guess = parseInt(document.getElementById('guessInput').value);
        if (isNaN(guess)) {
            document.getElementById('message').textContent = "Entrez un nombre valide.";
            return;
        }
        tentatives++;
        if (guess === chiffreSecret) {
            document.getElementById('message').textContent = `Bravo ! Tu as trouv√© en ${tentatives} tentatives ! D√©fi r√©ussi !`;
            completeDefi('devinechiffre');
        } else if (guess < chiffreSecret) {
            document.getElementById('message').textContent = `C'est plus grand. Essaie encore.`;
        } else {
            document.getElementById('message').textContent = `C'est plus petit. Essaie encore.`;
        }
    };
}

// D√©fi 2: Mot m√©lang√©
function jeuMotMelange() {
    reset();
    const mots = ["√âTOILE", "ORDINATEUR", "PROGRAMMATION", "CODAGE", "JEUX"];
    const motSecret = mots[Math.floor(Math.random() * mots.length)];
    const motMelange = motSecret.split('').sort(() => 0.5 - Math.random()).join('');
    document.getElementById('game-container').innerHTML = `
        <h2>D√©fi 2: Mot m√©lang√©</h2>
        <p>Remets les lettres dans le bon ordre : <b>${motMelange}</b></p>
        <input type="text" id="motInput" />
        <br/><br/>
        <button class="answer-btn" id="motBtn">Valider</button>
    `;
    document.getElementById('motBtn').onclick = () => {
        const reponse = document.getElementById('motInput').value.toUpperCase().trim();
        if (reponse === motSecret) {
            document.getElementById('message').textContent = 'Bravo, d√©fi r√©ussi !';
            completeDefi('melange');
        } else {
            document.getElementById('message').textContent = `Faux, essaie encore.`;
        }
    };
}

// D√©fi 3: Compte les fruits
function jeuCompteFruits() {
    reset();
    const fruits = ['üçé', 'üçå', 'üçá', 'üçé', 'üçå', 'üçé', 'üçá', 'üçå', 'üçé'];
    const fruitAChoisir = fruits[Math.floor(Math.random() * fruits.length)];
    const count = fruits.filter(f => f === fruitAChoisir).length;
    document.getElementById('game-container').innerHTML = `
        <h2>D√©fi 3: Compte les fruits</h2>
        <p>Combien y a-t-il de **${fruitAChoisir}** ?</p>
        <h3>${fruits.join(' ')}</h3>
        <input type="number" id="countInput" />
        <br/><br/>
        <button class="answer-btn" id="countBtn">Valider</button>
    `;
    document.getElementById('countBtn').onclick = () => {
        const reponse = parseInt(document.getElementById('countInput').value);
        if (reponse === count) {
            document.getElementById('message').textContent = 'Bravo, d√©fi r√©ussi !';
            completeDefi('compte');
        } else {
            document.getElementById('message').textContent = `Faux, essaie encore.`;
        }
    };
}

// D√©fi 4: Ordre alphab√©tique
function jeuOrdreAlpha() {
    reset();
    const mots = ["HTML", "CSS", "JAVASCRIPT", "PYTHON"];
    const shuffled = [...mots].sort(() => Math.random() - 0.5);
    const sorted = [...mots].sort();
    let index = 0;
    const container = document.getElementById('game-container');
    const message = document.getElementById('message');
    container.innerHTML = `
        <h2>D√©fi 4: Ordre alphab√©tique</h2>
        <p>Clique sur les mots dans le bon ordre :</p>
        <div id="alpha-btns"></div>
    `;
    const btnDiv = document.getElementById('alpha-btns');
    shuffled.forEach(mot => {
        const btn = document.createElement('button');
        btn.textContent = mot;
        btn.classList.add('answer-btn');
        btn.onclick = () => {
            if (mot === sorted[index]) {
                index++;
                message.textContent = `Bonne r√©ponse !`;
                btn.disabled = true;
                if (index === mots.length) {
                    message.textContent = `Bravo, d√©fi r√©ussi !`;
                    completeDefi('ordrealpha');
                }
            } else {
                message.textContent = `Faux, le prochain mot est ${sorted[index]}. Recommence !`;
                setTimeout(() => jeuOrdreAlpha(), 2000);
            }
        };
        btnDiv.appendChild(btn);
    });
}

// D√©fi 5: Couleurs en m√©moire
function jeuCouleurMemoire() {
    reset();
    const couleurs = ['red', 'blue', 'green', 'yellow'];
    let sequence = [];
    const sequenceLength = 4;
    let index = 0;
    let playing = false;

    const container = document.getElementById('game-container');
    const message = document.getElementById('message');

    container.innerHTML = `
        <h2>D√©fi 5: Couleurs en m√©moire</h2>
        <p>Regarde bien la s√©quence de couleurs, puis reproduis-la.</p>
        <div id="color-lights" style="display:flex; justify-content:center; gap:10px;"></div>
        <div id="color-btns" style="margin-top:20px;"></div>
    `;

    const lightsDiv = document.getElementById('color-lights');
    const btnsDiv = document.getElementById('color-btns');
    
    couleurs.forEach(c => {
        const light = document.createElement('div');
        light.style.width = '50px';
        light.style.height = '50px';
        light.style.backgroundColor = 'gray';
        light.style.borderRadius = '50%';
        light.style.border = '2px solid white';
        light.id = `light-${c}`;
        lightsDiv.appendChild(light);

        const btn = document.createElement('button');
        btn.classList.add('answer-btn');
        btn.style.backgroundColor = c;
        btn.textContent = '';
        btn.onclick = () => {
            if (playing) return;
            checkSequence(c);
        };
        btnsDiv.appendChild(btn);
    });

    function playSequence() {
        playing = true;
        sequence = [];
        for (let i = 0; i < sequenceLength; i++) {
            sequence.push(couleurs[Math.floor(Math.random() * couleurs.length)]);
        }
        let i = 0;
        const interval = setInterval(() => {
            if (i >= sequence.length) {
                clearInterval(interval);
                playing = false;
                index = 0;
                message.textContent = '√Ä ton tour !';
                return;
            }
            const light = document.getElementById(`light-${sequence[i]}`);
            light.style.backgroundColor = sequence[i];
            setTimeout(() => {
                light.style.backgroundColor = 'gray';
            }, 500);
            i++;
        }, 1000);
    }

    function checkSequence(color) {
        if (color === sequence[index]) {
            index++;
            if (index === sequence.length) {
                message.textContent = 'Bravo ! D√©fi r√©ussi !';
                completeDefi('couleurmemoire');
            }
        } else {
            message.textContent = 'Faux ! Recommence...';
            setTimeout(() => jeuCouleurMemoire(), 2000);
        }
    }
    
    playSequence();
}

// D√©fi 6: √ânigmes
function jeuEnigmes() {
    reset();
    const enigmes = [
        { q: "Qu'est-ce qui a des dents mais ne peut pas manger ?", a: "un r√¢teau" },
        { q: "Je suis un fruit qui a des p√©pins. Qui suis-je ?", a: "pomme" },
        { q: "Je suis √† la fois un animal et un v√™tement. Qui suis-je ?", a: "pull" }
    ];
    const enigme = enigmes[Math.floor(Math.random() * enigmes.length)];
    document.getElementById('game-container').innerHTML = `
        <h2>D√©fi 6: √ânigmes</h2>
        <p>${enigme.q}</p>
        <input type="text" id="enigmeInput" />
        <br/><br/>
        <button class="answer-btn" id="enigmeBtn">Valider</button>
    `;
    document.getElementById('enigmeBtn').onclick = () => {
        const reponse = document.getElementById('enigmeInput').value.toLowerCase().trim();
        if (reponse === enigme.a) {
            document.getElementById('message').textContent = 'Excellente logique, d√©fi r√©ussi !';
            completeDefi('riddles');
        } else {
            document.getElementById('message').textContent = 'Mauvaise r√©ponse. R√©fl√©chis bien...';
        }
    };
}

// D√©fi 7: Le Poids Id√©al
function jeuPoidsIdeal() {
    reset();
    const objets = [
        { nom: "un chat", poids: 4, unit: "kg" },
        { nom: "un t√©l√©phone", poids: 200, unit: "g" },
        { nom: "une voiture", poids: 1, unit: "tonne" }
    ];
    const obj = objets[Math.floor(Math.random() * objets.length)];
    document.getElementById('game-container').innerHTML = `
        <h2>D√©fi 7: Le Poids Id√©al</h2>
        <p>Quel est le poids id√©al pour **${obj.nom}** ?</p>
        <input type="number" id="poidsInput" placeholder="Poids en ${obj.unit}" />
        <br/><br/>
        <button class="answer-btn" id="poidsBtn">Valider</button>
    `;
    document.getElementById('poidsBtn').onclick = () => {
        const poids = parseFloat(document.getElementById('poidsInput').value);
        if (poids === obj.poids) {
            document.getElementById('message').textContent = `Bravo ! C'est le poids id√©al. D√©fi r√©ussi !`;
            completeDefi('poids');
        } else if (poids < obj.poids) {
            document.getElementById('message').textContent = `C'est trop l√©ger. Essaie encore !`;
        } else {
            document.getElementById('message').textContent = `C'est trop lourd. Essaie encore !`;
        }
    };
}

// D√©fi 8: V√©rit√© ou Mensonge
function jeuVeriteMensonge() {
    reset();
    const declarations = [
        { d: "L'eau bout √† 100¬∞C √† pression atmosph√©rique standard.", a: true },
        { d: "Le Mont Blanc est la plus haute montagne du monde.", a: false },
        { d: "Les fourmis n'ont pas de poumons.", a: true },
        { d: "Une girafe a la m√™me longueur de cou que le cou d'un √™tre humain.", a: false }
    ];
    let index = 0;
    let score = 0;
    const container = document.getElementById('game-container');
    const message = document.getElementById('message');
    
    function showDeclaration() {
        if(index >= declarations.length) {
            container.innerHTML = `<h3>Fini ! Score : ${score} / ${declarations.length}</h3>`;
            if (score === declarations.length) {
                message.textContent = "D√©fi r√©ussi !";
                completeDefi('veritefaux');
            } else {
                message.textContent = "D√©fi √©chou√©. Essaie encore.";
            }
            return;
        }
        const d = declarations[index];
        container.innerHTML = `<h2>${d.d}</h2>`;
        const btnVrai = document.createElement('button');
        btnVrai.textContent = 'Vrai';
        btnVrai.classList.add('answer-btn');
        btnVrai.onclick = () => answer(true);
        container.appendChild(btnVrai);

        const btnFaux = document.createElement('button');
        btnFaux.textContent = 'Faux';
        btnFaux.classList.add('answer-btn');
        btnFaux.onclick = () => answer(false);
        container.appendChild(btnFaux);
    }
    function answer(val) {
        if(val === declarations[index].a) score++;
        index++;
        showDeclaration();
    }
    showDeclaration();
}

// D√©fi 9: Le Symbole Manquant
function jeuSymboleManquant() {
    reset();
    const series = [
        { s: ['‚ñ≤','‚óè','‚ñ†','‚ñ≤','‚óè','‚ñ†','‚ñ≤','‚óè','?'], a: '‚ñ†' },
        { s: ['‚≠ê','‚ö´Ô∏è','‚≠ê','‚ö´Ô∏è','?','‚ö´Ô∏è'], a: '‚≠ê' },
        { s: ['üçé','üçé','üçå','üçé','üçé','üçå','?','üçé','üçå'], a: 'üçé' }
    ];
    const serie = series[Math.floor(Math.random()*series.length)];
    const shuffledButtons = [...new Set(serie.s)].filter(s => s !== '?').sort(() => Math.random() - 0.5);
    document.getElementById('game-container').innerHTML = `
        <h2>D√©fi 9: Le Symbole Manquant</h2>
        <p>Quel est le symbole manquant dans cette s√©rie ?</p>
        <h3>${serie.s.join(' ')}</h3>
    `;
    const btnDiv = document.createElement('div');
    shuffledButtons.forEach(s => {
        const btn = document.createElement('button');
        btn.textContent = s;
        btn.classList.add('answer-btn');
        btn.onclick = () => {
            if (s === serie.a) {
                document.getElementById('message').textContent = 'Bravo ! D√©fi r√©ussi !';
                completeDefi('symbole');
            } else {
                document.getElementById('message').textContent = 'Faux, essaie encore.';
            }
        };
        btnDiv.appendChild(btn);
    });
    document.getElementById('game-container').appendChild(btnDiv);
}

// D√©fi 10: La S√©rie de Formes (connecte les formes)
function jeuSerieFormes() {
    reset();
    const formes = ['square', 'circle', 'triangle', 'square', 'circle', 'triangle'];
    const shuffled = [...formes].sort(() => Math.random() - 0.5);
    let index = 0;
    const container = document.getElementById('game-container');
    const message = document.getElementById('message');
    container.innerHTML = `
        <h2>D√©fi 10: La S√©rie de Formes</h2>
        <p>Clique sur les formes dans cet ordre : Carr√©, Cercle, Triangle.</p>
        <div id="shapes-grid"></div>
    `;
    const grid = document.createElement('div');
    grid.style.display = 'grid';
    grid.style.gridTemplateColumns = 'repeat(3, 1fr)';
    grid.style.gap = '15px';

    const shapeMap = {
        square: '<span>‚ñ†</span>',
        circle: '<span>‚óè</span>',
        triangle: '<span>‚ñ≤</span>'
    };

    shuffled.forEach(forme => {
        const btn = document.createElement('button');
        btn.innerHTML = shapeMap[forme];
        btn.classList.add('answer-btn');
        btn.onclick = () => {
            if(forme === formes[index]) {
                index++;
                btn.disabled = true;
                message.textContent = 'Bonne forme !';
                if(index === formes.length / 2) {
                    message.textContent = 'Bravo ! D√©fi r√©ussi !';
                    completeDefi('seriesuite');
                }
            } else {
                message.textContent = 'Mauvaise forme ! Recommence.';
                setTimeout(() => jeuSerieFormes(), 2000);
            }
        };
        grid.appendChild(btn);
    });
    container.appendChild(grid);
}
</script>
</body>
</html>
